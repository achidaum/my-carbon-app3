import streamlit as st

# --- 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÅ‡∏≠‡∏õ ---
st.set_page_config(page_title="Thai Carbon Daily Tracker", layout="centered")

# ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏î‡πâ‡∏ß‡∏¢ CSS (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡∏´‡∏•‡∏∏‡∏î‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 7 ‡πÅ‡∏•‡∏∞ 8)
st.markdown("""
    <style>
    .main { background-color: #f8fafc; }
    h1 { color: #15803d; text-align: center; }
    div.stButton > button:first-child {
        background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
        color: white; border-radius: 12px; border: none; width: 100%; font-weight: bold; height: 3.5em;
    }
    .result-card {
        background: white; padding: 25px; border-radius: 20px; 
        border-top: 10px solid #22c55e; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        text-align: center;
    }
    .advice-card {
        background: #ffffff; padding: 15px; border-radius: 12px;
        border-left: 5px solid #10b981; margin-bottom: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    </style>
    """, unsafe_allow_html=True)

st.markdown("<h1>üåø Thai Carbon Daily Tracker</h1>", unsafe_allow_html=True)

st.info("**‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏∞‡∏´‡∏ô‡∏±‡∏Å‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (‡∏≠‡∏¥‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢ 10.4 kgCO2e)")

# --- 2. ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ---
col1, col2 = st.columns(2)
with col1:
    st.markdown("#### üöó ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á")
    # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Syntax Error ‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3 (‡∏õ‡∏¥‡∏î string ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö)
    transport = st.selectbox("‡∏û‡∏≤‡∏´‡∏ô‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ", 
        ["‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô)", "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (EV)", "‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå", "‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (BTS/MRT)", "‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå", "‡πÄ‡∏î‡∏¥‡∏ô/‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô"])
    distance = st.number_input("‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á (‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£)", min_value=0.0, step=1.0, value=10.0)
    
    st.markdown("#### üí° ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô")
    # ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 12 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏Ç‡∏≠
    ac_hours = st.slider("‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏£‡πå‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)", 0, 12, 0)

with col2:
    st.markdown("#### üçΩÔ∏è ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡πÇ‡∏†‡∏Ñ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (3 ‡∏°‡∏∑‡πâ‡∏≠)")
    food_1 = st.text_input("‡∏°‡∏∑‡πâ‡∏≠‡πÄ‡∏ä‡πâ‡∏≤", placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏°‡∏π‡πÅ‡∏î‡∏á")
    food_2 = st.text_input("‡∏°‡∏∑‡πâ‡∏≠‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ß")
    food_3 = st.text_input("‡∏°‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡πá‡∏ô", placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏•‡∏±‡∏î‡∏ú‡∏±‡∏Å")

st.markdown("<br>", unsafe_allow_html=True)

# --- 3. ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç NameError ‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 5 ‡πÅ‡∏•‡∏∞ Syntax ‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 4) ---
if st.button("‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå"):
    # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á
    ef_map = {
        "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô)": 0.218, 
        "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (EV)": 0.05, 
        "‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå": 0.08, 
        "‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (BTS/MRT)": 0.02, 
        "‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå": 0.03, 
        "‡πÄ‡∏î‡∏¥‡∏ô/‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô": 0
    }
    carbon_t = distance * ef_map[transport]
    
    # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏≤‡∏´‡∏≤‡∏£
    def calc_food(text):
        if not text: return 0.0
        t = text.lower()
        if any(x in t for x in ["‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ß", "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠", "beef"]): return 7.5
        if any(x in t for x in ["‡∏ú‡∏±‡∏Å", "‡∏™‡∏•‡∏±‡∏î", "‡πÄ‡∏à", "‡∏°‡∏±‡∏á‡∏™‡∏ß‡∏¥‡∏£‡∏±‡∏ï‡∏¥"]): return 0.4
        return 1.2
    
    carbon_f = calc_food(food_1) + calc_food(food_2) + calc_food(food_3)
    carbon_e = ac_hours * 0.51
    
    total = carbon_t + carbon_f + carbon_e

    # --- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ---
    st.markdown(f"""
        <div class="result-card">
            <h3 style="margin:0; color: #4b5563;">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
            <h1 style="margin:0; color: #16a34a; font-size: 50px;">{total:.2f} <span style="font-size: 20px; color: #9ca3af;">kgCO2e</span></h1>
            <p style="color: #6b7280;">‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 10.4 kg ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</p>
        </div>
    """, unsafe_allow_html=True)

    if total <= 6.0:
        st.success("üü¢ **‡∏£‡∏∞‡∏î‡∏±‡∏ö: ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°** - ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏≤‡∏Å!")
    elif total <= 11.0:
        st.warning("üü° **‡∏£‡∏∞‡∏î‡∏±‡∏ö: ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á** - ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ")
    else:
        st.error("üö® **‡∏£‡∏∞‡∏î‡∏±‡∏ö: ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Å‡πä‡∏≤‡∏ã‡∏™‡∏π‡∏á** - ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Å‡πä‡∏≤‡∏ã‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢")

    # --- 4. ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Error ‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 7 ‡πÅ‡∏•‡∏∞ 8) ---
    st.markdown("---")
    st.markdown("### üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Å‡πä‡∏≤‡∏ã (Reduction)")
    c1, c2 = st.columns(2)
    with c1:
        st.markdown("<div class='advice-card'><b>üöó ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</b><br>‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏£‡∏ñ‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞‡∏´‡∏£‡∏∑‡∏≠ Carpool<br>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡∏•‡∏°‡∏¢‡∏≤‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠</div>", unsafe_allow_html=True)
    with c2:
        st.markdown("<div class='advice-card'><b>üçΩÔ∏è ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡πÇ‡∏†‡∏Ñ:</b><br>‚Ä¢ ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ß‡πÉ‡∏ô‡∏ö‡∏≤‡∏á‡∏°‡∏∑‡πâ‡∏≠<br>‚Ä¢ ‡∏ó‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î‡∏•‡∏î‡∏Ç‡∏¢‡∏∞‡∏≠‡∏≤‡∏´‡∏≤‡∏£</div>", unsafe_allow_html=True)

    st.markdown("### üåø ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ (Offsetting)")
    st.info(f"""
    **‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô {total:.2f} kg ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡∏Ñ‡∏∑‡∏≠:**
    * **‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ:** 1 ‡∏ï‡πâ‡∏ô‡∏î‡∏π‡∏î‡∏ã‡∏±‡∏ö CO2 ‡πÑ‡∏î‡πâ ~10 kg/‡∏õ‡∏µ (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)
    * **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏î‡πÇ‡∏•‡∏Å‡∏£‡πâ‡∏≠‡∏ô:** ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏â‡∏•‡∏≤‡∏Å‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏ü‡∏∏‡∏ï‡∏û‡∏£‡∏¥‡πâ‡∏ô‡∏ó‡πå
    * **‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÑ‡∏ü:** ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏£‡πå 25-26 ‡∏≠‡∏á‡∏®‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
    """)

st.markdown("---")
st.caption("‡∏≠‡πâ‡∏≤‡∏á‡∏≠
